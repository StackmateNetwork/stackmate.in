

<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.74.3" />
    <meta name="description" content="Demonstrates how to recover your solo account.">
<meta name="author" content="Vishal Menon - @vmenond">

    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
<link rel="manifest" href="/icons/site.webmanifest">
<link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

    <title>Solo Account Recovery :: Stackmate India</title>

    
    <link href="/css/nucleus.css?1621866864" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1621866864" rel="stylesheet">
    <link href="/css/hybrid.css?1621866864" rel="stylesheet">
    <link href="/css/featherlight.min.css?1621866864" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1621866864" rel="stylesheet">
    <link href="/css/auto-complete.css?1621866864" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1621866864" rel="stylesheet">
    <link href="/css/theme.css?1621866864" rel="stylesheet">
    <link href="/css/hugo-theme.css?1621866864" rel="stylesheet">
    
    <link href="/css/theme-blue.css?1621866864" rel="stylesheet">
    
    <link href="/css/style.css?1621866864" rel="stylesheet"><link href="/css/jsonview.css?1621866864" rel="stylesheet"><link href="/css/blog.css?1621866864" rel="stylesheet">

    <meta property="og:title" content="Solo Account Recovery" />
<meta property="og:description" content="Demonstrates how to recover your solo account." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://stackmate.in/blog/2021/02/solo-account-recovery/" />
<meta property="og:image" content="https://stackmate.in/static/images/vault.pdf"/>
<meta property="article:published_time" content="2021-02-23T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-02-23T00:00:00+00:00" />

    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://stackmate.in/static/images/vault.pdf"/>

<meta name="twitter:title" content="Solo Account Recovery"/>
<meta name="twitter:description" content="Demonstrates how to recover your solo account."/>


    <script src="/js/jquery-3.3.1.min.js?1621866864"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/blog/2021/02/solo-account-recovery/">
    


<nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">
    <img src="/images/Stackmate.png" style="width: 50px;height: 50px;" alt="Stackmate India logo"/>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1621866864"></script>
<script type="text/javascript" src="/js/auto-complete.js?1621866864"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/stackmate.in";
    
</script>
<script type="text/javascript" src="/js/search.js?1621866864"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/learn/" title="Learn" class="dd-item
        
        
        
        ">
      <a href="/learn/">
          <i class="fas fa-graduation-cap"></i> Learn
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/exchanges/" title="Buy Bitcoin" class="dd-item
        
        
        
        ">
      <a href="/exchanges/">
          <i class="fas fa-coins"></i> Buy Bitcoin
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/storage/" title="Storage" class="dd-item
        
        
        
        ">
      <a href="/storage/">
          <i class="fas fa-lock"></i> Storage
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/regulation/" title="Regulation" class="dd-item
        
        
        
        ">
      <a href="/regulation/">
          <i class="fas fa-id-card"></i> Regulation
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/privacy/" title="Privacy" class="dd-item
        
        
        
        ">
      <a href="/privacy/">
          <i class="fas fa-user-lock"></i> Privacy
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/foss/" title="FOSS" class="dd-item
        
        
        
        ">
      <a href="/foss/">
          <i class="fas fa-terminal"></i> FOSS
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/professionals/" title="Professionals" class="dd-item
        
        
        
        ">
      <a href="/professionals/">
          <i class="fas fa-check"></i> Professionals
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/blog/" title="Blog" class="dd-item
        parent
        
        
        ">
      <a href="/blog/">
          <i class="fas fa-newspaper"></i> Blog
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://bitcoinaudible.com/library/"><i class='fas fa-headphones-alt'></i> Essential Listening</a>
              </li>
          
              <li>
                  <a class="padding" href="https://nakamotoinstitute.org/literature"><i class='fas fa-book-open'></i> Essential Reading</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <script type="text/javascript" src="/js/github-buttons.js"></script>

<center>
    
    <a class="github-button" href="https://github.com/StackmateNetwork/stackmate.in/subscription" data-icon="octicon-eye" data-show-count="true" aria-label="Watch StackmateNetwork/stackmate.in on GitHub">Watch</a>
    <a class="github-button" href="https://github.com/StackmateNetwork/stackmate.in" data-icon="octicon-star" data-show-count="true" aria-label="Star StackmateNetwork/stackmate.in on GitHub">Star</a>
    <a class="github-button" href="https://github.com/StackmateNetwork/stackmate.in/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork this website on StackmateNetwork/stackmate.in on GitHub">Fork</a>
</center>

<br>
<center>

<i style='font-size: 20px' class='fab fa-linux'></i>
<i style='font-size: 20px' class='fab fa-bitcoin'></i>
<i style='font-size: 20px' class='fab fa-buffer'></i>
</center>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/StackmateNetwork/stackmate.inblog/2021/solo_recovery.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                   Solo Account Recovery
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#initial-setup">Initial Setup</a>
      <ul>
        <li><a href="#step-0-install-a-recent-version-bdk-cli">Step 0: Install a recent version <code>bdk-cli</code></a></li>
        <li><a href="#step-1-recover-extended-master-private-key-from-a-seed">Step 1: Recover extended master private key from a seed</a></li>
        <li><a href="#step-2-extract-extended-master-private-key">Step 2: Extract extended master private key</a></li>
        <li><a href="#step-3-derive-extended-public-keys">Step 3: Derive extended public keys</a></li>
        <li><a href="#step-4-create-wallet-descriptor">Step 4: Create wallet descriptor</a></li>
        <li><a href="#step-5-sync-descriptor-wallet-and-confirm-balance">Step 5: Sync descriptor wallet and confirm balance</a></li>
        <li><a href="#step-6-view-wallet-spending-policies">Step 6: View wallet spending policies</a></li>
        <li><a href="#step-7-create-spending-transaction">Step 7: Create spending transaction</a></li>
        <li><a href="#step-8-sign-and-finalize-psbts">Step 8: Sign and finalize PSBTs</a></li>
        <li><a href="#step-9-broadcast-finalized-psbt">Step 9: Broadcast finalized PSBT</a></li>
        <li><a href="#step-10-confirm-transaction-included-in-a-testnet-block">Step 10: Confirm transaction included in a testnet block</a></li>
        <li><a href="#done">DONE!</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        


<div class="tags">

  <a class="tag-link" href="/blog/tags/guide">guide</a>

  <a class="tag-link" href="/blog/tags/recovery">recovery</a>

</div>


        </div>
        
        <div id="body-inner">
          
            
            <h1 class="blog-title">Solo Account Recovery </h1>
            
                <span class="blog-author">By </span><span class="blog-author"><a href="/authors/vishal-menon">Vishal Menon</a></span>
            
            
          

        


<blockquote>
<p>This tutorial is a stripped down version of Steve Myers and Thundabirds article from bdk-cli</p>
</blockquote>
<p>In this post we will use the <a href="https://github.com/bitcoindevkit/bdk-cli">bdk-cli</a> tool to recover accounts from a bitcoin seed.</p>
<ol>
<li>recover your seed&rsquo;s extended master key and derive child account keys</li>
<li>create a <a href="https://bitcoinops.org/en/topics/psbt/">PSBT</a> to unlock your unspent bitcoin</li>
<li>sign and finalize the resulting PSBTs</li>
<li>broadcast and confirm spending transactions via <a href="https://blockstream.info">Blockstream</a></li>
</ol>
<p><em>Note: We use testnet in the examples for you to try. If you repeat these instructions on your own your mainnet seed - the extended keys, addresses, and other values will be different than shown in this post, but the end results should be the same.</em></p>
<h2 id="initial-setup">Initial Setup</h2>
<h3 id="step-0-install-a-recent-version-bdk-cli">Step 0: Install a recent version <code>bdk-cli</code></h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl --proto <span style="color:#e6db74">&#39;=https&#39;</span> --tlsv1.2 -sSf https://sh.rustup.rs | sh
cargo install bdk-cli --features repl,electrum,esplora

<span style="color:#75715e"># confirm bdk-cli is installed</span>
bdk-cli --version
BDK CLI 0.2.0

<span style="color:#75715e"># bdk-cli usage can be explored with the `help` sub-command</span>
bdk-cli help
</code></pre></div><h3 id="step-1-recover-extended-master-private-key-from-a-seed">Step 1: Recover extended master private key from a seed</h3>
<p>Generate new extended private keys for each of our wallet participants:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bdk-cli key restore --mnemonic <span style="color:#e6db74">&#34;witness poverty pulse crush era item game rose bargain quantum spawn sure way behave also basket journey worry stem entry toddler floor way bone&#34;</span> |  tee apna-key.json
<span style="color:#f92672">{</span>
  <span style="color:#e6db74">&#34;fingerprint&#34;</span>: <span style="color:#e6db74">&#34;5adb4683&#34;</span>,
  <span style="color:#e6db74">&#34;xprv&#34;</span>: <span style="color:#e6db74">&#34;tprv8ZgxMBicQKsPeAuGznXJZwfWHgWo86dFuufRBZN7ZT44UzoNG2cYmZLNLrnsm7eXhGSeccRU2nTtxunT11UkpqrRhJQefBnFJeHBddF68bg&#34;</span>
<span style="color:#f92672">}</span>

</code></pre></div><h3 id="step-2-extract-extended-master-private-key">Step 2: Extract extended master private key</h3>
<p>Here we use the <code>jq</code> Unix command to parse the json output of the <code>bdk-cli</code> commands.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt-get install jq -y

export MY_XPRV<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>cat apna-key.json | jq -r <span style="color:#e6db74">&#39;.xprv&#39;</span><span style="color:#66d9ef">)</span>

</code></pre></div><h3 id="step-3-derive-extended-public-keys">Step 3: Derive extended public keys</h3>
<p>All stackmate live wallets use account 0 by the standard <a href="https://github.com/bitcoin/bips/blob/master/bip-0084.mediawiki">BIP-84</a> key path: <code>m/84h/1h/0h/0/*</code> to derive extended public keys to share with other wallet participants.</p>
<p>Note that the <code>key derive</code> sub-command will generate a tpub for the last hardened node in the given derivation path. You&rsquo;ll also notice that <code>bdk-cli</code> will returns our tpub with the key origin (fingerprint/path) added to it (the metadata part that looks like <code>[5adb4683/84'/1'/0']</code> right before the tpub). This key origin information is not necessary in order to use a tpub and generate addresses, but it&rsquo;s good practice to include it because some signers require it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export MY_XPUB<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>bdk-cli key derive --xprv $MY_XPRV --path <span style="color:#e6db74">&#34;m/84&#39;/1&#39;/0&#39;/0&#34;</span> | jq -r <span style="color:#e6db74">&#34;.xpub&#34;</span><span style="color:#66d9ef">)</span>
echo <span style="color:#ae81ff">\&#34;</span>$MY_XPUB<span style="color:#ae81ff">\&#34;</span>
<span style="color:#e6db74">&#34;[5adb4683/84&#39;/1&#39;/0&#39;]tpubDCyRBuncqwyAjSNiw1GWLmwQsWyhgPMEBpx3ZNpnCwZwf3HXerspTpaneN81KRxkwj8vjqH9pNWEPgNhen7dfE212SHfxBBbsCywxQGxvvu/0/*&#34;</span>

</code></pre></div><h3 id="step-4-create-wallet-descriptor">Step 4: Create wallet descriptor</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export MY_DESCRIPTOR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;wpkh(pk(</span>$MY_XPRV<span style="color:#e6db74">/84&#39;/1&#39;/0&#39;/0/*))&#34;</span>

</code></pre></div><h3 id="step-5-sync-descriptor-wallet-and-confirm-balance">Step 5: Sync descriptor wallet and confirm balance</h3>
<p>This step must be done by apna, Bob, and Carol so their individual descriptor wallets know about the faucet transaction they will later be spending the output of.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bdk-cli wallet -w apna -d $MY_DESCRIPTOR sync       
<span style="color:#f92672">{}</span>
bdk-cli wallet -w apna -d $MY_DESCRIPTOR get_balance
<span style="color:#f92672">{</span>
  <span style="color:#e6db74">&#34;satoshi&#34;</span>: <span style="color:#ae81ff">10000</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="step-6-view-wallet-spending-policies">Step 6: View wallet spending policies</h3>
<p>This can also be done by any wallet participant, as long as they have the same descriptor and extended public keys from the other particpants..</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bdk-cli wallet -w apna -d $MY_DESCRIPTOR policies
<span style="color:#f92672">{</span>
  <span style="color:#e6db74">&#34;external&#34;</span>: <span style="color:#f92672">{</span>
    <span style="color:#e6db74">&#34;contribution&#34;</span>: <span style="color:#f92672">{</span>
      <span style="color:#e6db74">&#34;conditions&#34;</span>: <span style="color:#f92672">{</span>
        <span style="color:#e6db74">&#34;0&#34;</span>: <span style="color:#f92672">[</span>
          <span style="color:#f92672">{}</span>
        <span style="color:#f92672">]</span>,
        <span style="color:#e6db74">&#34;3&#34;</span>: <span style="color:#f92672">[</span>
          <span style="color:#f92672">{</span>
            <span style="color:#e6db74">&#34;csv&#34;</span>: <span style="color:#ae81ff">2</span>
          <span style="color:#f92672">}</span>
        <span style="color:#f92672">]</span>
      <span style="color:#f92672">}</span>,
      <span style="color:#e6db74">&#34;items&#34;</span>: <span style="color:#f92672">[</span>
        0,
        <span style="color:#ae81ff">3</span>
      <span style="color:#f92672">]</span>,
      <span style="color:#e6db74">&#34;m&#34;</span>: 3,
      <span style="color:#e6db74">&#34;n&#34;</span>: 4,
      <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;PARTIAL&#34;</span>
    <span style="color:#f92672">}</span>,
    <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;ydtnup84&#34;</span>,
    <span style="color:#e6db74">&#34;items&#34;</span>: <span style="color:#f92672">[</span>
      <span style="color:#f92672">{</span>
        <span style="color:#e6db74">&#34;contribution&#34;</span>: <span style="color:#f92672">{</span>
          <span style="color:#e6db74">&#34;condition&#34;</span>: <span style="color:#f92672">{}</span>,
          <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;COMPLETE&#34;</span>
        <span style="color:#f92672">}</span>,
        <span style="color:#e6db74">&#34;fingerprint&#34;</span>: <span style="color:#e6db74">&#34;5adb4683&#34;</span>,
        <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;uyxvyzqt&#34;</span>,
        <span style="color:#e6db74">&#34;satisfaction&#34;</span>: <span style="color:#f92672">{</span>
          <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;NONE&#34;</span>
        <span style="color:#f92672">}</span>,
        <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;SIGNATURE&#34;</span>
      <span style="color:#f92672">}</span>,
      <span style="color:#f92672">{</span>
        <span style="color:#e6db74">&#34;contribution&#34;</span>: <span style="color:#f92672">{</span>
          <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;NONE&#34;</span>
        <span style="color:#f92672">}</span>,
        <span style="color:#e6db74">&#34;fingerprint&#34;</span>: <span style="color:#e6db74">&#34;5fdec309&#34;</span>,
        <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;dzkmxcgu&#34;</span>,
        <span style="color:#e6db74">&#34;satisfaction&#34;</span>: <span style="color:#f92672">{</span>
          <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;NONE&#34;</span>
        <span style="color:#f92672">}</span>,
        <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;SIGNATURE&#34;</span>
      <span style="color:#f92672">}</span>,
      <span style="color:#f92672">{</span>
        <span style="color:#e6db74">&#34;contribution&#34;</span>: <span style="color:#f92672">{</span>
          <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;NONE&#34;</span>
        <span style="color:#f92672">}</span>,
        <span style="color:#e6db74">&#34;fingerprint&#34;</span>: <span style="color:#e6db74">&#34;de41e56d&#34;</span>,
        <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;ekfu5uaw&#34;</span>,
        <span style="color:#e6db74">&#34;satisfaction&#34;</span>: <span style="color:#f92672">{</span>
          <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;NONE&#34;</span>
        <span style="color:#f92672">}</span>,
        <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;SIGNATURE&#34;</span>
      <span style="color:#f92672">}</span>,
      <span style="color:#f92672">{</span>
        <span style="color:#e6db74">&#34;contribution&#34;</span>: <span style="color:#f92672">{</span>
          <span style="color:#e6db74">&#34;condition&#34;</span>: <span style="color:#f92672">{</span>
            <span style="color:#e6db74">&#34;csv&#34;</span>: <span style="color:#ae81ff">2</span>
          <span style="color:#f92672">}</span>,
          <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;COMPLETE&#34;</span>
        <span style="color:#f92672">}</span>,
        <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;8kel7sdw&#34;</span>,
        <span style="color:#e6db74">&#34;satisfaction&#34;</span>: <span style="color:#f92672">{</span>
          <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;NONE&#34;</span>
        <span style="color:#f92672">}</span>,
        <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;RELATIVETIMELOCK&#34;</span>,
        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#ae81ff">2</span>
      <span style="color:#f92672">}</span>
    <span style="color:#f92672">]</span>,
    <span style="color:#e6db74">&#34;satisfaction&#34;</span>: <span style="color:#f92672">{</span>
      <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;NONE&#34;</span>
    <span style="color:#f92672">}</span>,
    <span style="color:#e6db74">&#34;threshold&#34;</span>: 3,
    <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;THRESH&#34;</span>
  <span style="color:#f92672">}</span>,
  <span style="color:#e6db74">&#34;internal&#34;</span>: null
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="step-7-create-spending-transaction">Step 7: Create spending transaction</h3>
<p>The transaction can also be created by apna, Bob, or Carol, or even an untrusted coordinator that only has all three tpubs.</p>
<p>Note that the argument provided to the &ndash;external_policy flag contains the id retrieved from the <code>policies</code> subcommand in the above step, in this case <code>ydtnup84</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bdk-cli wallet -w apna -d $MY_DESCRIPTOR create_tx -a --to tb1qm5tfegjevj27yvvna9elym9lnzcf0zraxgl8z2:0 --external_policy <span style="color:#e6db74">&#34;{\&#34;ydtnup84\&#34;: [0,1,2]}&#34;</span>
<span style="color:#f92672">{</span>
  <span style="color:#e6db74">&#34;details&#34;</span>: <span style="color:#f92672">{</span>
    <span style="color:#e6db74">&#34;fees&#34;</span>: 169,
    <span style="color:#e6db74">&#34;height&#34;</span>: null,
    <span style="color:#e6db74">&#34;received&#34;</span>: 0,
    <span style="color:#e6db74">&#34;sent&#34;</span>: 10000,
    <span style="color:#e6db74">&#34;timestamp&#34;</span>: 1614058791,
    <span style="color:#e6db74">&#34;transaction&#34;</span>: null,
    <span style="color:#e6db74">&#34;txid&#34;</span>: <span style="color:#e6db74">&#34;3b9a7ac610afc91f1d1a0dd844e609376278fe7210c69b7ef663c5a8e8308f3e&#34;</span>
  <span style="color:#f92672">}</span>,
  <span style="color:#e6db74">&#34;psbt&#34;</span>: <span style="color:#e6db74">&#34;cHNidP8BAFIBAAAAAYx7T0cL7EoUYBEU0mSL6+DS4VQafUzJgAf0Ftlbkya5AQAAAAD/////AWcmAAAAAAAAFgAU3RacollkleIxk+lz8my/mLCXiH0AAAAAAAEBKxAnAAAAAAAAIgAgCBH16JNfSPhmjJR75EdDB+gSCEF7tStNOLqw/k3BvA0BBXchA3c1Ak2kcGOzOh6eRXFKfpnpzP1lzfcXIYhxFGZG51mxrHwhA75YDXRLDLt+eX5UsE03mIGUSsQP2MrJ9lm17cGXDw2mrJN8IQIvNjaP+mwNC0DtgaB6ENB/DPPlbUDR6+NZ4Sw070jzOKyTfHZjUrJpaJNThyIGAi82No/6bA0LQO2BoHoQ0H8M8+VtQNHr41nhLDTvSPM4DO66tnIAAAAAAAAAACIGA3c1Ak2kcGOzOh6eRXFKfpnpzP1lzfcXIYhxFGZG51mxGFrbRoNUAACAAQAAgAAAAIAAAAAAAAAAACIGA75YDXRLDLt+eX5UsE03mIGUSsQP2MrJ9lm17cGXDw2mDEMxpeYAAAAAAAAAAAAA&#34;</span>
<span style="color:#f92672">}</span>

export UNSIGNED_PSBT<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>bdk-cli wallet -w apna -d $MY_DESCRIPTOR create_tx -a --to tb1qm5tfegjevj27yvvna9elym9lnzcf0zraxgl8z2:0 --external_policy <span style="color:#e6db74">&#34;{\&#34;ydtnup84\&#34;: [0,1,2]}&#34;</span> | jq -r <span style="color:#e6db74">&#34;.psbt&#34;</span><span style="color:#66d9ef">)</span>
</code></pre></div><h3 id="step-8-sign-and-finalize-psbts">Step 8: Sign and finalize PSBTs</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># SIGN AND FINALIZE PSBT</span>
bdk-cli wallet -w apna -d $MY_DESCRIPTOR sign --psbt $UNSIGNED_PSBT
<span style="color:#f92672">{</span>
  <span style="color:#e6db74">&#34;is_finalized&#34;</span>: true,
  <span style="color:#e6db74">&#34;psbt&#34;</span>: <span style="color:#e6db74">&#34;cHNidP8BAFIBAAAAAYx7T0cL7EoUYBEU0mSL6+DS4VQafUzJgAf0Ftlbkya5AQAAAAD/////AWcmAAAAAAAAFgAU3RacollkleIxk+lz8my/mLCXiH0AAAAAAAEBKxAnAAAAAAAAIgAgCBH16JNfSPhmjJR75EdDB+gSCEF7tStNOLqw/k3BvA0iAgIvNjaP+mwNC0DtgaB6ENB/DPPlbUDR6+NZ4Sw070jzOEcwRAIgRPXSwFLfzD1YQzw5FGYA0TgiQ+D88hSOVDbvyUZDiPUCIAbguaSGgCbBAXo5sIxpZ4c1dcGkYyrrqnDjc1jcdJ1CASICA3c1Ak2kcGOzOh6eRXFKfpnpzP1lzfcXIYhxFGZG51mxSDBFAiEA0kdkvlA+k5kUBWVUM8SkR4Ua9pnXF66ECVwIM1l0doACIF0aMiORVC35+M3GHF2Vl8Q7t455mebrr1HuLaAyxBOYASICA75YDXRLDLt+eX5UsE03mIGUSsQP2MrJ9lm17cGXDw2mRzBEAiBPJlQEnuVDHgfgOdTZNlIcRZz2iqHoMWfDmLMFqJSOQAIgCuOcTKp/VaaqwIjnYfMKO3eQ1k9pOygSWt6teT1o13QBAQV3IQN3NQJNpHBjszoenkVxSn6Z6cz9Zc33FyGIcRRmRudZsax8IQO+WA10Swy7fnl+VLBNN5iBlErED9jKyfZZte3Blw8NpqyTfCECLzY2j/psDQtA7YGgehDQfwzz5W1A0evjWeEsNO9I8zisk3x2Y1KyaWiTU4ciBgIvNjaP+mwNC0DtgaB6ENB/DPPlbUDR6+NZ4Sw070jzOBjeQeVtVAAAgAEAAIAAAACAAAAAAAAAAAAiBgN3NQJNpHBjszoenkVxSn6Z6cz9Zc33FyGIcRRmRudZsQwpbm6KAAAAAAAAAAAiBgO+WA10Swy7fnl+VLBNN5iBlErED9jKyfZZte3Blw8NpgxDMaXmAAAAAAAAAAABBwABCP1TAQUARzBEAiBE9dLAUt/MPVhDPDkUZgDROCJD4PzyFI5UNu/JRkOI9QIgBuC5pIaAJsEBejmwjGlnhzV1waRjKuuqcONzWNx0nUIBRzBEAiBPJlQEnuVDHgfgOdTZNlIcRZz2iqHoMWfDmLMFqJSOQAIgCuOcTKp/VaaqwIjnYfMKO3eQ1k9pOygSWt6teT1o13QBSDBFAiEA0kdkvlA+k5kUBWVUM8SkR4Ua9pnXF66ECVwIM1l0doACIF0aMiORVC35+M3GHF2Vl8Q7t455mebrr1HuLaAyxBOYAXchA3c1Ak2kcGOzOh6eRXFKfpnpzP1lzfcXIYhxFGZG51mxrHwhA75YDXRLDLt+eX5UsE03mIGUSsQP2MrJ9lm17cGXDw2mrJN8IQIvNjaP+mwNC0DtgaB6ENB/DPPlbUDR6+NZ4Sw070jzOKyTfHZjUrJpaJNThwAA&#34;</span>
</code></pre></div><h3 id="step-9-broadcast-finalized-psbt">Step 9: Broadcast finalized PSBT</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bdk-cli wallet -w apna -d $MY_DESCRIPTOR broadcast --psbt $FINAL_PSBT
<span style="color:#f92672">{</span>
  <span style="color:#e6db74">&#34;txid&#34;</span>: <span style="color:#e6db74">&#34;3b9a7ac610afc91f1d1a0dd844e609376278fe7210c69b7ef663c5a8e8308f3e&#34;</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="step-10-confirm-transaction-included-in-a-testnet-block">Step 10: Confirm transaction included in a testnet block</h3>
<p><a href="https://mempool.space/testnet/tx/3b9a7ac610afc91f1d1a0dd844e609376278fe7210c69b7ef663c5a8e8308f3e">https://mempool.space/testnet/tx/3b9a7ac610afc91f1d1a0dd844e609376278fe7210c69b7ef663c5a8e8308f3e</a></p>
<p>And new wallet balance is now zero.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bdk-cli wallet -w apna -d $MY_DESCRIPTOR sync
<span style="color:#f92672">{}</span>
bdk-cli wallet -w apna -d $MY_DESCRIPTOR get_balance
<span style="color:#f92672">{</span>
  <span style="color:#e6db74">&#34;satoshi&#34;</span>: <span style="color:#ae81ff">0</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="done">DONE!</h3>


<footer class="footline">
	
</footer>

        
        </div>
        

<script src="https://utteranc.es/client.js"
        repo="StackmateNetwork/stackmate.in/blog-comments"
        issue-term="pathname"
        label="blog-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>



      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
        
                    
                        
            
            
        
                    
                        
            
            
        
                    
            
        
                    
            
        

        


	 
	 
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1621866864"></script>
    <script src="/js/perfect-scrollbar.min.js?1621866864"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1621866864"></script>
    <script src="/js/jquery.sticky.js?1621866864"></script>
    <script src="/js/featherlight.min.js?1621866864"></script>
    <script src="/js/highlight.pack.js?1621866864"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1621866864"></script>
    <script src="/js/learn.js?1621866864"></script>
    <script src="/js/hugo-learn.js?1621866864"></script>
    
        
            <script src="/mermaid/mermaid.js?1621866864"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    <script type="text/javascript" src="/js/jsonview.js" charset="utf-8"></script>
<script type="text/javascript" src="/js/main.js" charset="utf-8"></script>

  </body>
</html>

